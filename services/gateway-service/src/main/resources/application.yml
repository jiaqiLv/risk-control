server:
  port: 8080

spring:
  application:
    name: gateway-service
  cloud:
    compatibility-verifier:
      enabled: false  # Disable Spring Cloud compatibility check

gateway:
  # Base URL of the orchestrator service
  orchestrator-base-url: http://localhost:8081
  # Request timeout in milliseconds
  timeout-ms: 5000
  # Enable request/response logging
  log-requests: true
  log-responses: true

# Sentinel configuration
spring.cloud.sentinel:
  transport:
    dashboard: localhost:8858  # Sentinel Dashboard address
    port: 8719                 # Sentinel API port
  eager: true                  # Enable early startup
  datasource:
    # Flow control rules
    flow:
      file:
        file: classpath:sentinel-rules.json
        rule-type: flow
        data-type: json
      # Uncomment below to use Nacos for rule persistence
      # nacos:
      #   server-addr: localhost:8848
      #   dataId: ${spring.application.name}-flow-rules
      #   groupId: SENTINEL_GROUP
      #   rule-type: flow

# Spring Actuator configuration
management:
  endpoints:
    web:
      exposure:
        include: health  # Only expose health in production
      base-path: /actuator
  endpoint:
    health:
      show-details: always
  metrics:
    export:
      simple:
        enabled: true

# Logging configuration
logging:
  level:
    root: INFO
    com.risk.gateway: DEBUG
    org.springframework.web: INFO
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/gateway-service.log
    max-size: 100MB
    max-history: 30

# JSON serialization
spring.jackson:
  serialization:
    write-dates-as-timestamps: true
    indent-output: false
  default-property-inclusion: non_null
